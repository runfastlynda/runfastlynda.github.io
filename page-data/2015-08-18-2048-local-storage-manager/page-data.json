{"componentChunkName":"component---node-modules-gatsby-theme-blog-core-src-templates-post-query-js","path":"/2015-08-18-2048-local-storage-manager/","result":{"data":{"site":{"siteMetadata":{"title":"runfastlynda","social":[{"name":"twitter","url":"https://twitter.com/runfastlynda"},{"name":"github","url":"https://github.com/runfastlynda"}]}},"blogPost":{"__typename":"MdxBlogPost","id":"24a3e711-0786-5719-85c0-d95c697c1ad4","excerpt":"前面一篇 已经介绍了input_mannager.js那一部分的代码，接着想了解游戏中的状态数据是怎么存储和调用的，所以来阅读local_storage_manager.js。 local_storage_manager.js包括两个部分：window.fakeStorage…","body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"date\": \"2015-08-18T00:00:00.000Z\",\n  \"title\": \"2048源代码解读（3）\",\n  \"categories\": [\"sourcecode\"]\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, mdx(\"a\", {\n    \"href\": \"http://runfastlynda.com/2048-input-mannager/\",\n    \"parentName\": \"p\"\n  }, \"\\u524D\\u9762\\u4E00\\u7BC7\"), \"\\u5DF2\\u7ECF\\u4ECB\\u7ECD\\u4E86input_mannager.js\\u90A3\\u4E00\\u90E8\\u5206\\u7684\\u4EE3\\u7801\\uFF0C\\u63A5\\u7740\\u60F3\\u4E86\\u89E3\\u6E38\\u620F\\u4E2D\\u7684\\u72B6\\u6001\\u6570\\u636E\\u662F\\u600E\\u4E48\\u5B58\\u50A8\\u548C\\u8C03\\u7528\\u7684\\uFF0C\\u6240\\u4EE5\\u6765\\u9605\\u8BFBlocal_storage_manager.js\\u3002\"), mdx(\"p\", null, \"local_storage_manager.js\\u5305\\u62EC\\u4E24\\u4E2A\\u90E8\\u5206\\uFF1Awindow.fakeStorage\\u548CLocalStorageManager\\u51FD\\u6570\\u3002\\u67E5\\u770B\\u5230\\u524D\\u8005\\u5728LocalStorageManager\\u51FD\\u6570\\u4E2D\\u6709\\u8C03\\u7528\\uFF0C\\u6240\\u4EE5\\u51B3\\u5B9A\\u5148\\u9605\\u8BFBLocalStorageManager\\u3002\"), mdx(\"p\", null, \"LocalStorageManager\\u51FD\\u6570\\u6709\\u5982\\u4E0B\\u7ED3\\u6784\\uFF1A\\n\", mdx(\"img\", {\n    \"src\": \"http://7xjufd.dl1.z0.glb.clouddn.com/blog3.1.png\",\n    \"parentName\": \"p\"\n  })), mdx(\"p\", null, \"\\u5728LocalStorageManager\\u51FD\\u6570\\u4E2D\\u5148\\u628A bestScoreKey\\u548CgameStateKey\\u7684\\u952E\\u8D4B\\u4E3AbestScore \\u4E0EgameState\\uFF0C\\u7136\\u540E\\u4F7F\\u7528\\u4E09\\u76EE\\u8FD0\\u7B97\\u7ED9 storage \\u8D4B\\u503C\\u3002\"), mdx(\"pre\", null, mdx(\"code\", {\n    \"className\": \"language-javascript\",\n    \"parentName\": \"pre\"\n  }, \"function LocalStorageManager() {\\nthis.bestScoreKey     = \\\"bestScore\\\";\\nthis.gameStateKey     = \\\"gameState\\\";\\n\\nvar supported = this.localStorageSupported();\\nthis.storage = supported ? window.localStorage : window.fakeStorage;\\n}\\n\\n//\\u5BF9supported\\u8FDB\\u884C\\u5224\\u65AD\\uFF08supported\\u4E0B\\u9762\\u6709\\u5B9A\\u4E49\\uFF09\\uFF0C\\u8FD4\\u56DEtrue\\u4F7F\\u7528window.localStorage\\uFF0C\\u5426\\u5219\\u4F7F\\u7528window.fakeStorage\\u3002\\n\")), mdx(\"p\", null, \"\\u8FD9\\u91CC\\u6D89\\u53CA\\u4E86supported\\u4E0Ewindow.fakeStorage\\u3002\\u4E0B\\u6587\\u4E00\\u4E00\\u4ECB\\u7ECD\\u3002\"), mdx(\"p\", null, \"\\u901A\\u8FC7\\u67E5\\u627E\\u65B9\\u6CD5\\u5728\\u539F\\u578B\\u94FE\\u627E\\u5230\\u4E86this.localStorageSupported\\u7684\\u5B9A\\u4E49\\uFF08\\u4E5F\\u5C31\\u662F\\u4E0A\\u6587\\u7684supported\\uFF09\\uFF0C\\u7528\\u9014\\u662F\\u4E3A\\u4E86\\u6D4B\\u8BD5\\u6D4F\\u89C8\\u5668\\u662F\\u5426\\u652F\\u6301window.localStorage\\u3002\"), mdx(\"pre\", null, mdx(\"code\", {\n    \"className\": \"language-javascript\",\n    \"parentName\": \"pre\"\n  }, \"LocalStorageManager.prototype. localStorageSupported= function () {\\n    var testKey = \\\"test\\\";\\n    var storage = window.localStorage;\\n    try {\\n      storage.setItem(testKey, \\\"1\\\");\\n      storage.removeItem(testKey);\\n      return true;\\n      } catch (error) {\\n        return false;\\n      }\\n\")), mdx(\"p\", null, \"\\u4F7F\\u7528try..catch\\u8BED\\u53E5\\u6D4B\\u8BD5storage.setItem\\u548Cstorage.removeItem\\uFF0C\\u6765\\u786E\\u4FDD\\u6D4F\\u89C8\\u5668\\u652F\\u6301window.localStorage\\uFF0C\\u6267\\u884C\\u6210\\u529F\\u8FD4\\u56DEtrue\\uFF0C\\u5426\\u5219\\u6267\\u884Ccatch\\u91CC\\u9762\\u7684\\u8BED\\u53E5\\u8FD4\\u56DEfalse\\u3002\"), mdx(\"p\", null, \"fakeStorage\\u5C31\\u662F\\u4F5C\\u8005\\u81EA\\u5DF1\\u5199\\u7684\\u4E00\\u4E2AlocalStorage\\u7684\\u66FF\\u4EE3\\u65B9\\u6CD5\\uFF0C\\u4E5F\\u5B9A\\u4E49\\u4E86setItem\\u65B9\\u6CD5\\uFF0CgetItem\\u65B9\\u6CD5\\u548CremoveItem\\u65B9\\u6CD5\\u3002\"), mdx(\"pre\", null, mdx(\"code\", {\n    \"className\": \"language-javascript\",\n    \"parentName\": \"pre\"\n  }, \"window.fakeStorage = {\\n    _data: {},\\n\\n    setItem: function (id, val) {\\n      return this._data[id] = String(val);\\n    },\\n\\n    getItem: function (id) {\\n      return this._data.hasOwnProperty(id) ? this._data[id] : undefined;\\n    },\\n\\n    removeItem: function (id) {\\n      return delete this._data[id];\\n    },\\n\\n    clear: function () {\\n      return this._data = {};\\n    }\\n  };\\n\")), mdx(\"p\", null, \"\\u6700\\u540E\\u4F7F\\u7528\\u4E86 JSON.parse()\\u548CJSON.stringify()\\u3002\"), mdx(\"p\", null, \"JSON.parse() \\u65B9\\u6CD5\\u5C06JSON \\u5B57\\u7B26\\u4E32\\u89E3\\u6790\\u6210\\u4E3A JavaScript \\u4E2D\\u5BF9\\u5E94\\u7684\\u57FA\\u672C\\u6570\\u636E\\u7C7B\\u578B\\u3002\"), mdx(\"p\", null, \"JSON.stringify() \\u65B9\\u6CD5\\u5C06\\u4EFB\\u610FJavaScript \\u5BF9\\u5E94\\u7684\\u57FA\\u672C\\u6570\\u636E\\u7C7B\\u578B\\u5E8F\\u5217\\u5316\\u6210 JSON \\u5B57\\u7B26\\u4E32\\u3002\"), mdx(\"pre\", null, mdx(\"code\", {\n    \"className\": \"language-javascript\",\n    \"parentName\": \"pre\"\n  }, \"LocalStorageManager.prototype.getGameState = function () {\\n  var stateJSON = this.storage.getItem(this.gameStateKey);\\n  return stateJSON ? JSON.parse(stateJSON) : null;\\n};\\n\\n\\nLocalStorageManager.prototype.setGameState = function (gameState) {\\n  this.storage.setItem(this.gameStateKey, JSON.stringify(gameState));\\n};\\n\")), mdx(\"p\", null, \"\\u9605\\u8BFB\\u5B8Clocal_storage_manager.js\\uFF0C\\u4E86\\u89E3\\u5176\\u4E0D\\u4EC5\\u4FDD\\u5B58\\u4E86\\u5206\\u6570\\uFF0C\\u8FD8\\u4FDD\\u5B58\\u4E86\\u6E38\\u620F\\u72B6\\u6001\\u3002\\u7531\\u6B64local_storage_manager.js\\u4F1A\\u88AB\\u7ECF\\u5E38\\u8C03\\u7528\\uFF0C\\u7F57\\u5217\\u4E00\\u4E0B\\u8C03\\u7528\\u60C5\\u51B5\\uFF1A\"), mdx(\"p\", null, \"game_manager.js\\u4E2D\\u8C03\\u7528\\u8FC7\"), mdx(\"ul\", null, mdx(\"li\", {\n    \"parentName\": \"ul\"\n  }, \"LocalStorageManager.getBestScore\"), mdx(\"li\", {\n    \"parentName\": \"ul\"\n  }, \"LocalStorageManager.setBestScore\"), mdx(\"li\", {\n    \"parentName\": \"ul\"\n  }, \"LocalStorageManager.setGameState\"), mdx(\"li\", {\n    \"parentName\": \"ul\"\n  }, \"LocalStorageManager.clearGameState\"), mdx(\"li\", {\n    \"parentName\": \"ul\"\n  }, \"LocalStorageManager.setBestScore\")), mdx(\"p\", null, \"grid.js\\u8C03\\u7528\"), mdx(\"ul\", null, mdx(\"li\", {\n    \"parentName\": \"ul\"\n  }, \"LocalStorageManager.setBestScore\")));\n}\n;\nMDXContent.isMDXComponent = true;","slug":"/2015-08-18-2048-local-storage-manager/","title":"2048源代码解读（3）","tags":[],"keywords":[],"date":"August 18, 2015","image":null,"imageAlt":null,"socialImage":null},"previous":{"__typename":"MdxBlogPost","id":"5242f8b8-8a63-5d8d-9ab0-1863e34ea4b0","excerpt":"源于参加百度ife训练营，我需要设计一个2048的小游戏，就像这样的： 有趣的是2048的作者将源码开放，最终在github里得到了项目的源代码，此时萌发了阅读源码的想法，说做就做，下面就是我的笔记了！ ###分析2048代码结构 使用  “git clone https…","slug":"/2015-08-13-read-2048-source-code/","title":"2048源代码解读（1）","date":"August 13, 2015"},"next":{"__typename":"MdxBlogPost","id":"df3aa815-811a-5765-a38a-0c0a94978935","excerpt":"已经阅读完 local_storage_manager.js 和 keyboard_input_manager.js ，这次阅读 html_actuator.js。 HTMLActuator函数有如下结构： 在函数的最开始获取了tile-container，score…","slug":"/2015-08-19-read-source-code-of-2048-4/","title":"2048源代码解读（4）","date":"August 19, 2015"}},"pageContext":{"id":"24a3e711-0786-5719-85c0-d95c697c1ad4","previousId":"5242f8b8-8a63-5d8d-9ab0-1863e34ea4b0","nextId":"df3aa815-811a-5765-a38a-0c0a94978935"}},"staticQueryHashes":["386998304","4198970465","764694655"]}